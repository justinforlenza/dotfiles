#!/bin/bash

# Get your actual device names using: wpctl status
HEADPHONES="alsa_output.usb-Elgato_Systems_Elgato_Wave_XLR_DS22K1A01343-00.analog-stereo"
SPEAKERS="alsa_output.usb-Creative_Technology_Ltd_Creative_Stage_Air_V2_Creative_Lab-01.analog-stereo"

# Get the Main Mix monitor source ID
MAIN_MIX_MONITOR=$(wpctl status | grep "Mixer: Main Mix" -A 1 | grep "monitor" | awk '{print $2}' | tr -d '.')

# Function to remove existing links from mixer_main:monitor outputs
remove_old_links() {
    echo "Removing old links..."
    # Remove links from both channels
    pw-link -d mixer_main:monitor_FL $HEADPHONES:playback_FL 2>/dev/null
    pw-link -d mixer_main:monitor_FR $HEADPHONES:playback_FR 2>/dev/null
    pw-link -d mixer_main:monitor_FL $SPEAKERS:playback_FL 2>/dev/null
    pw-link -d mixer_main:monitor_FR $SPEAKERS:playback_FR 2>/dev/null
}

if [ "$1" = "headphones" ]; then
    remove_old_links
    pw-link mixer_main:monitor_FL $HEADPHONES:playback_FL
    pw-link mixer_main:monitor_FR $HEADPHONES:playback_FR
    echo "Switched to Headphones"
elif [ "$1" = "speakers" ]; then
    remove_old_links
    pw-link mixer_main:monitor_FL $SPEAKERS:playback_FL
    pw-link mixer_main:monitor_FR $SPEAKERS:playback_FR
    echo "Switched to Speakers"
else
    echo "Usage: $0 {headphones|speakers}"
    exit 1
fi
